module.exports=__NEXT_REGISTER_PAGE("/lab/player",function(){var e=webpackJsonp([13],{400:function(e,t,n){"use strict";var r=n(1);var a=n.n(r);var o=n(5);t["a"]=function(){return a.a.createElement(o["d"],{textAlign:"center"},a.a.createElement("span",{style:{color:"#9EABB3"}},"#陆止于此，海始于斯#"))}},432:function(e,t,n){"use strict";var r=n(21);var a=n.n(r);var o=n(1);var i=n.n(o);var c=n(152);var l=n(408);var u=n(409);var s=n(186);function f(e){f="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return f(e)}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};var r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})));r.forEach(function(t){d(e,t,n[t])})}return e}function d(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:true,configurable:true,writable:true}):e[t]=n;return e}function h(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function i(e,t){try{var n=o[e](t);var i=n.value}catch(e){a(e);return}n.done?r(i):Promise.resolve(i).then(c,l)}function c(e){i("next",e)}function l(e){i("throw",e)}c()})}}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;"value"in r&&(r.writable=true);Object.defineProperty(e,r.key,r)}}function g(e,t,n){t&&y(e.prototype,t);n&&y(e,n);return e}function v(e,t){if(t&&("object"===f(t)||"function"===typeof t))return t;return E(e)}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t["a"]=function(e){return Object(c["connect"])(null,null)(function(t){b(n,t);function n(){m(this,n);return v(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}g(n,[{key:"render",value:function t(){var n=this.props.global||{};return[i.a.createElement(l["a"],{key:"head",title:n.title||s["a"].title}),i.a.createElement(u["a"],{key:"header",logo:n.logo||null,search:n.search||false}),i.a.createElement(e,this.props)]}}],[{key:"getInitialProps",value:function(){var t=h(a.a.mark(function t(n){var r,o;return a.a.wrap(function t(a){while(1)switch(a.prev=a.next){case 0:r={};n.req;if(!e.getInitialProps){a.next=7;break}a.next=5;return e.getInitialProps(n);case 5:o=a.sent;return a.abrupt("return",p({global:r},o));case 7:return a.abrupt("return",{global:r});case 8:case"end":return a.stop()}},t,this)}));return function e(n){return t.apply(this,arguments)}}()}]);return n}(o["Component"]))}},984:function(e,t,n){e.exports=n(985)},985:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=n(21);var a=n.n(r);var o=n(1);var i=n.n(o);var c=n(2);var l=n.n(c);var u=n(159);var s=n.n(u);var f=n(13);var p=n(162);var d={TOGGLE_MUSIC_LIST:"TOGGLE_MUSIC_LIST",PLAY_SPECIAL_MUSIC:"PLAY_SPECIAL_MUSIC",CHANGE_PLAY_PROGRESS:"CHANGE_PLAY_PROGRESS",CHANGE_VOLUME_PROGRESS:"CHANGE_VOLUME_PROGRESS",PLAY_MUSIC:"PLAY_MUSIC",PAUSE_MUSIC:"PAUSE_MUSIC",CHANGE_PLAY_MODE:"CHANGE_PLAY_MODE",TOGGLE_MUTE:"TOGGLE_MUTE",PLAY_PRE_MUSIC:"PLAY_PRE_MUSIC",PLAY_NEXT_MUSIC:"PLAY_NEXT_MUSIC",INIT_MUSIC_DURATION:"INIT_MUSIC_DURATION",LOAD_MUSIC:"LOAD_MUSIC",REFRESH_MUSICS:"REFRESH_MUSICS",TOGGLE_LIST_TYPE:"TOGGLE_LIST_TYPE",APPEND_PLAY_LIST:"APPEND_PLAY_LIST",SET_MUSIC_INFO:"SET_MUSIC_INFO",TOGGLE_IF_EDIT:"TOGGLE_IF_EDIT",REDUCE_PLAY_LIST:"REDUCE_PLAY_LIST"};var h=function e(t,n,r){return{type:d.SET_MUSIC_INFO,id:t,url:n,cover:r}};var m=function e(t){return{type:d.REFRESH_MUSICS,musics:t}};var y=function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{type:d.APPEND_PLAY_LIST,music:t,play:n}};var g=function e(t){return{type:d.TOGGLE_LIST_TYPE,listType:t}};var v=function e(){return{type:d.TOGGLE_MUSIC_LIST}};var E=function e(t){return{type:d.PLAY_SPECIAL_MUSIC,musicId:t}};var b=function e(t){return{type:d.CHANGE_PLAY_PROGRESS,playProgress:t}};var C=function e(t){return{type:d.CHANGE_VOLUME_PROGRESS,volumeProgress:t}};var P=function e(){return{type:d.PLAY_MUSIC}};var _=function e(){return{type:d.PAUSE_MUSIC}};var S=function e(){return{type:d.PLAY_PRE_MUSIC}};var I=function e(){return{type:d.PLAY_NEXT_MUSIC}};var O=function e(){return{type:d.CHANGE_PLAY_MODE}};var k=function e(){return{type:d.TOGGLE_MUTE}};var T=function e(t){return{type:d.INIT_MUSIC_DURATION,duration:t}};var L=function e(){return{type:d.LOAD_MUSIC,loading:true}};var M=function e(){return{type:d.LOAD_MUSIC,loading:false}};var w=function e(){return{type:d.TOGGLE_IF_EDIT}};var A=function e(t){return{type:d.REDUCE_PLAY_LIST,id:t}};function R(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;"value"in r&&(r.writable=true);Object.defineProperty(e,r.key,r)}}function j(e,t,n){t&&U(e.prototype,t);n&&U(e,n);return e}var G=function(){function e(){R(this,e)}j(e,null,[{key:"parseTime",value:function e(t){var n=0;t&&(n=t);var r=parseInt(n/3600,10);r=0===r?"":"".concat(r,":");var a=this.prefixInteger(parseInt(n%3600/60,10),2);var o=this.prefixInteger(parseInt(n%60,10),2);return"".concat(r).concat(a,":").concat(o)}},{key:"prefixInteger",value:function e(t,n){return(Array(n).join("0")+t).slice(-n)}},{key:"last",value:function e(t,n){var r=this.index(t,n)-1+n.length;return n[r%n.length].id}},{key:"next",value:function e(t,n){var r=this.index(t,n)+1;return n[r%n.length].id}},{key:"random",value:function e(t,n){var r=n.length;var a=Math.ceil(Math.random()*(r-1));var o=this.index(t,n)+a;return n[o%r].id}},{key:"index",value:function e(t,n){var r=-1;n.forEach(function(e,n){e.id===t&&(r=n)});return r}},{key:"get",value:function e(t,n){if(n)return n.filter(function(e){return e.id===t})[0];return null}}]);return e}();var N=G;var x=[{id:1,song:"我",singer:"张国荣",src:"http://oxrjqkvly.bkt.clouddn.com/%E6%88%91%28%E5%9B%BD%E8%AF%AD%29-%E5%BC%A0%E5%9B%BD%E8%8D%A3.mp3",cover:"http://oxrjqkvly.bkt.clouddn.com/%E4%B8%BALeslie%E8%87%B4%E6%95%AC%203.png"}];var H=n(163);var Y=n(186);var D=Y["a"].neteaseApi;var F=function e(t){return new Promise(function(e,n){var r="".concat(D,"search?keywords=").concat(t);H["a"].neteaseFetch(r).then(function(t){e(t.result)}).catch(function(e){n(e.error||"未知错误")})})};var B=function e(t){return new Promise(function(e,n){var r="".concat(D,"song/detail?ids=").concat(t);H["a"].neteaseFetch(r).then(function(t){e(t.songs)}).catch(function(e){n(e.error||"未知错误")})})};var z=function e(t){return new Promise(function(e,n){var r="".concat(D,"music/url?id=").concat(t);H["a"].neteaseFetch(r).then(function(t){e(t.data)}).catch(function(e){n(e.error||"未知错误")})})};var X={SEARCH:"SEARCH",SEARCH_SUCCESS:"SEARCH_SUCCESS",SEARCH_ERROR:"SEARCH_ERROR",FETCH_MUSIC_URL:"FETCH_MUSIC_URL",FETCH_MUSIC_URL_SUCCESS:"FETCH_MUSIC_URL_SUCCESS",FETCH_MUSIC_URL_ERROR:"FETCH_MUSIC_URL_ERROR"};var V=function e(t){if(t)return{id:t.id,song:t.name,singer:t.artists[0].name,src:"",cover:""};return{}};var W=function e(){return{type:X.SEARCH}};var q=function e(t,n){return{type:X.SEARCH_SUCCESS,songs:t,total:n}};var J=function e(t){return{type:X.SEARCH_ERROR,error:t}};var K=function e(t){return function(e,n){var r=n().netMusic.loading;if(r)return e(J("请求中，稍后再试"));if(!t)return e(J("输入关键字"));e(W());return F(t).then(function(t){e(q(t.songs.map(function(e){return V(e)})));e(g("search"))}).catch(function(t){e(J(t))})}};var Q=function e(t){return{type:X.FETCH_MUSIC_URL_ERROR,error:t}};var Z=function e(){return function(e,t){var n=t().player,r=n.loading,a=n.musicId;if(r)return e(Q("请求中，稍后再试"));if(!a)return e(Q("id 不能为空"));e(L());return z(a).then(function(e){console.log(e)}).catch(function(t){e(Q(t))})}};var $={loading:false,total:0,songs:[],receivedAt:0,error:null};var ee=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$;var n=arguments.length>1?arguments[1]:void 0;switch(n.type){case X.SEARCH:return Object.assign({},t,{loading:true});case X.SEARCH_SUCCESS:return Object.assign({},t,{loading:false,songs:n.songs,total:n.total,receivedAt:(new Date).getTime(),error:null});case X.SEARCH_ERROR:return Object.assign({},t,{loading:false,error:n.error});default:return t}};var te=ee;function ne(e){ne="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return ne(e)}var re={MUSIC_CACHE:"_cache"};var ae=function e(t){if("undefined"!==typeof localStorage)return localStorage.getItem(t);return null};var oe=function e(t,n){if("undefined"===typeof localStorage)return;"object"===ne(n)?localStorage.setItem(t,JSON.stringify(n)):localStorage.setItem(t,n)};var ie=function e(t){if("undefined"===typeof localStorage)return;localStorage.removeItem(t)};var ce=JSON.parse(ae(re.MUSIC_CACHE))||x;var le={loading:true,play:false,slideOpen:false,musics:ce,musicId:ce[0].id,playProgress:0,volumeProgress:.3,mode:"repeat",mute:false,duration:0,listType:"play",edit:false};var ue=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:le;var n=arguments.length>1?arguments[1]:void 0;switch(n.type){case d.TOGGLE_LIST_TYPE:return Object.assign({},t,{listType:n.listType});case d.TOGGLE_MUSIC_LIST:return Object.assign({},t,{slideOpen:!t.slideOpen});case d.PLAY_SPECIAL_MUSIC:return Object.assign({},t,{musicId:n.musicId,play:true});case d.CHANGE_PLAY_PROGRESS:return Object.assign({},t,{playProgress:n.playProgress});case d.CHANGE_VOLUME_PROGRESS:return Object.assign({},t,{mute:false,volumeProgress:n.volumeProgress});case d.PLAY_MUSIC:case d.PAUSE_MUSIC:return Object.assign({},t,{play:!t.play});case d.CHANGE_PLAY_MODE:var r=t.mode;r="repeat"===r?"random":"random"===r?"lock":"repeat";return Object.assign({},t,{mode:r});case d.TOGGLE_MUTE:return Object.assign({},t,{mute:!t.mute});case d.PLAY_PRE_MUSIC:var a=t.mode;var o=t.musicId;"repeat"===a?o=N.last(t.musicId,t.musics):"random"===a&&(o=N.random(t.musicId,t.musics));return Object.assign({},t,{musicId:o,playProgress:0,play:true});case d.PLAY_NEXT_MUSIC:var i=t.mode;var c=t.musicId;"repeat"===i?c=N.next(t.musicId,t.musics):"random"===i&&(c=N.random(t.musicId,t.musics));return Object.assign({},t,{musicId:c,playProgress:0,play:true});case d.INIT_MUSIC_DURATION:return Object.assign({},t,{duration:n.duration});case d.LOAD_MUSIC:return Object.assign({},t,{loading:n.loading});case d.REFRESH_MUSICS:return Object.assign({},t,{musics:n.musics});case d.APPEND_PLAY_LIST:var l=n.music,u=n.play;var s=t.musics.filter(function(e){return e.id===l.id}).length>0;s||oe(re.MUSIC_CACHE,t.musics.concat(l));return Object.assign({},t,{musics:s?t.musics:t.musics.concat(l),musicId:u?l.id:t.musicId,play:!!u||t.play});case d.SET_MUSIC_INFO:var f=Object.assign([],t.musics);var p=n.id,h=n.url,m=n.cover;var y=N.index(p,f);f[y].src=h;m&&(f[y].cover=m);oe(re.MUSIC_CACHE,f);return Object.assign({},t,{musics:f});case d.TOGGLE_IF_EDIT:return Object.assign({},t,{edit:!t.edit});case d.REDUCE_PLAY_LIST:var g=n.id;if(1===t.musics.length)return Object.assign({},t,{edit:false});var v=t.musics.filter(function(e){return e.id!==g});oe(re.MUSIC_CACHE,v);return Object.assign({},t,{musics:v});default:return t}};var se=Object(f["combineReducers"])({player:ue,netMusic:te});var fe=function e(){return Object(f["createStore"])(se,p["a"])};var pe=fe;var de=n(432);var he=n(152);var me=n(5);function ye(e){ye="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return ye(e)}function ge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;"value"in r&&(r.writable=true);Object.defineProperty(e,r.key,r)}}function Ee(e,t,n){t&&ve(e.prototype,t);n&&ve(e,n);return e}function be(e,t){if(t&&("object"===ye(t)||"function"===typeof t))return t;return Ce(e)}function Ce(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pe(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _e=function(e){Pe(t,e);function t(){ge(this,t);return be(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}Ee(t,[{key:"shouldComponentUpdate",value:function e(t){if(!t.src)return false;return true}},{key:"render",value:function e(){var t=this.props,n=t.src,r=t.play;return[i.a.createElement(me["j"],{key:"cover-component",className:r?"cover":"cover pause",src:n,circular:true}),i.a.createElement("style",{key:"cover-style",jsx:"true"},"\n                img.cover {\n                    width: 280px;\n                    height: 280px;\n                    margin: .5rem auto;\n                    margin-top: 4rem;\n\n                    animation: rotate 30s linear infinite;\n                }\n\n                img.pause {\n                    animation-play-state: paused;\n                    -webkit-animation-play-state: paused; /* Safari 和 Chrome */\n                }\n\n                @keyframes rotate {\n                    0% {\n                        transform: rotate(0deg);\n                    }\n                    100% {\n                        transform: rotate(360deg);\n                    }\n                }\n            ")]}}]);return t}(o["Component"]);_e.defaultProps={src:""};var Se=_e;var Ie=function e(t){var n=t.music;return i.a.createElement(me["d"],{textAlign:"center"},i.a.createElement(me["h"],{as:"h3",content:n.song}),n.singer)};Ie.defaultProps={music:{id:"",song:"未知歌曲",singer:"未知歌手"}};var Oe=Ie;var ke=n(400);var Te=function e(t){var n=t.current,r=t.music,a=t.edit,o=t.onClickItem,c=t.onEdit;var l=function e(){return o(r.id,true)};var u=function e(t){c(r.id,false);t.stopPropagation()};return i.a.createElement(me["m"].Item,{className:n?"current":"",style:{height:"2.4rem"},onClick:l},i.a.createElement(me["m"].Content,{as:"span"},r.song),i.a.createElement(me["m"].Content,{floated:"right"},r.singer,a&&i.a.createElement(me["i"],{name:"send",link:true,color:"red",style:{marginLeft:"5px"},onClick:u})))};var Le=Te;function Me(e){Me="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return Me(e)}function we(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;"value"in r&&(r.writable=true);Object.defineProperty(e,r.key,r)}}function Re(e,t,n){t&&Ae(e.prototype,t);n&&Ae(e,n);return e}function Ue(e,t){if(t&&("object"===Me(t)||"function"===typeof t))return t;return Ge(e)}function je(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function Ge(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Ne=function(e){je(t,e);function t(e){var n;we(this,t);n=Ue(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.handleSearch=n.handleSearch.bind(Ge(n));n.handleTogglePlayList=n.handleTogglePlayList.bind(Ge(n));n.handleToggleSearchList=n.handleToggleSearchList.bind(Ge(n));n.handleClickSearchListItem=n.handleClickSearchListItem.bind(Ge(n));n.handleToggleIfEdit=n.handleToggleIfEdit.bind(Ge(n));n.handleReducePlayList=n.handleReducePlayList.bind(Ge(n));return n}Re(t,[{key:"componentWillUnmount",value:function e(){oe(re.MUSIC_CACHE,this.props.musics)}},{key:"handleSearch",value:function e(t){if("Enter"===t.key){var n=this.keyword.inputRef.value;n&&this.props.searchIfNeeded(n)}}},{key:"handleTogglePlayList",value:function e(){this.props.changeListType("play")}},{key:"handleToggleSearchList",value:function e(){this.props.changeListType("search")}},{key:"handleToggleIfEdit",value:function e(){this.props.toggleIfEdit()}},{key:"handleClickSearchListItem",value:function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var r=N.get(t,this.props.searchMusics);this.props.appendPlayList(r,n)}},{key:"handleReducePlayList",value:function e(t){this.props.reducePlayList(t)}},{key:"render",value:function e(){var t=this;var n=this.props,r=n.listType,a=n.musicId,o=n.musics,c=n.searchMusics,l=n.onClickItem,u=n.loading,s=n.edit;var f=i.a.createElement(ke["a"],null);"play"===r&&o.length>0?f=o.map(function(e){var n=e.id===a;return i.a.createElement(Le,{key:e.id,current:n,edit:s,music:e,onClickItem:l,onEdit:t.handleReducePlayList})}):c.length>0&&(f=c.map(function(e){var n=e.id===a;return i.a.createElement(Le,{key:e.id,current:n,edit:s,music:e,onClickItem:t.handleClickSearchListItem,onEdit:t.handleClickSearchListItem})}));return i.a.createElement("div",{className:"musiclist-container"},i.a.createElement(me["h"],{dividing:true},i.a.createElement(me["h"].Content,null,i.a.createElement(me["g"],null,i.a.createElement(me["g"].Column,{width:6},i.a.createElement(me["a"].Group,{basic:true,size:"mini"},i.a.createElement(me["a"],{icon:"play",onClick:this.handleTogglePlayList}),i.a.createElement(me["a"],{icon:"list",onClick:this.handleToggleSearchList}),i.a.createElement(me["a"],{icon:"setting",onClick:this.handleToggleIfEdit}))),i.a.createElement(me["g"].Column,{width:10},i.a.createElement(me["k"],{style:{fontSize:"12px",padding:".1rem"},size:"mini",ref:function e(n){t.keyword=n},icon:"search",loading:u,placeholder:"Search...",onKeyPress:this.handleSearch}))))),i.a.createElement(me["m"],{divided:true,relaxed:true,celled:true,animated:true,verticalAlign:"middle"},f))}}]);return t}(i.a.PureComponent);Ne.defaultProps={musics:[],searchMusics:[]};var xe=function e(t){return{listType:t.player.listType,edit:t.player.edit,loading:t.netMusic.loading,searchMusics:t.netMusic.songs}};var He=function e(t){return{searchIfNeeded:Object(f["bindActionCreators"])(K,t),changeListType:Object(f["bindActionCreators"])(g,t),appendPlayList:Object(f["bindActionCreators"])(y,t),toggleIfEdit:Object(f["bindActionCreators"])(w,t),reducePlayList:Object(f["bindActionCreators"])(A,t)}};var Ye=Object(he["connect"])(xe,He)(Ne);function De(e){De="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return De(e)}function Fe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;"value"in r&&(r.writable=true);Object.defineProperty(e,r.key,r)}}function ze(e,t,n){t&&Be(e.prototype,t);n&&Be(e,n);return e}function Xe(e,t){if(t&&("object"===De(t)||"function"===typeof t))return t;return We(e)}function Ve(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function We(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var qe=function(e){Ve(t,e);function t(e){var n;Fe(this,t);n=Xe(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.cover=null;n.handleClickItem=n.handleClickItem.bind(We(n));n.refreshHeight=n.refreshHeight.bind(We(n));return n}ze(t,[{key:"componentDidMount",value:function e(){var t=this;this.refreshHeight();var n=window.onresize;window.onresize=function(){n&&n();t.refreshHeight()}}},{key:"refreshHeight",value:function e(){var t=document.body.clientHeight;var n=document.getElementById("playerHeader").offsetHeight;var r=document.getElementById("playerControl").offsetHeight;var a=t-n-r;this.playerContent.style.height="".concat(a,"px")}},{key:"handleClickItem",value:function e(t){this.props.dispatch(E(t))}},{key:"render",value:function e(){var t=this;var n=this.props,r=n.slideOpen,a=n.musicId,o=n.musics,c=n.play;var l=N.get(a,o);var u=l&&l.cover?l.cover:this.cover;return i.a.createElement("div",{ref:function e(n){t.playerContent=n},id:"playerContent"},i.a.createElement(me["t"].Pushable,null,i.a.createElement(me["t"],{animation:"overlay",visible:r,width:"wide",direction:"right"},i.a.createElement(Ye,{musicId:a,musics:o,onClickItem:this.handleClickItem})),i.a.createElement(me["t"].Pusher,null,i.a.createElement(me["g"],{textAlign:"center"},i.a.createElement(me["g"].Row,null,i.a.createElement(me["g"].Column,null,i.a.createElement(Se,{src:u,play:c}))),i.a.createElement(me["g"].Row,null,i.a.createElement(me["g"].Column,null,i.a.createElement(Oe,{music:l})))))))}}]);return t}(o["Component"]);qe.defaultProps={musics:[]};var Je=function e(t){return{slideOpen:t.player.slideOpen,musicId:t.player.musicId,musics:t.player.musics,play:t.player.play}};var Ke=Object(he["connect"])(Je)(qe);function Qe(e){Qe="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return Qe(e)}function Ze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;"value"in r&&(r.writable=true);Object.defineProperty(e,r.key,r)}}function et(e,t,n){t&&$e(e.prototype,t);n&&$e(e,n);return e}function tt(e,t){if(t&&("object"===Qe(t)||"function"===typeof t))return t;return rt(e)}function nt(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function rt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var at=function(e){nt(t,e);function t(e){var n;Ze(this,t);n=tt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.handleChangeProgress=n.handleChangeProgress.bind(rt(n));return n}et(t,[{key:"handleChangeProgress",value:function e(t){var n=(t.clientX-this.progress.getBoundingClientRect().left)/this.progress.clientWidth;this.props.onChangeProgress(n,true)}},{key:"render",value:function e(){var t=this;var n=this.props,r=n.offsetX,a=n.percent;var o={marginTop:"15px",marginLeft:r,cursor:"pointer"};return i.a.createElement("div",{className:"ui red tiny progress","data-percent":100*a,style:o,ref:function e(n){t.progress=n},onClick:this.handleChangeProgress},i.a.createElement("div",{className:"bar",style:{width:"".concat(100*a,"%"),minWidth:0}}))}}]);return t}(o["PureComponent"]);at.defaultProps={offsetX:"0",percent:0,onChangeProgress:function e(){}};var ot=at;function it(e){it="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return it(e)}function ct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;"value"in r&&(r.writable=true);Object.defineProperty(e,r.key,r)}}function ut(e,t,n){t&&lt(e.prototype,t);n&&lt(e,n);return e}function st(e,t){if(t&&("object"===it(t)||"function"===typeof t))return t;return pt(e)}function ft(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function pt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var dt=function(e){ft(t,e);function t(e){var n;ct(this,t);n=st(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.audio=null;n.task=null;n.handleAudioCanPlay=n.handleAudioCanPlay.bind(pt(n));n.handleToggleMusicList=n.handleToggleMusicList.bind(pt(n));n.handlePlayMusic=n.handlePlayMusic.bind(pt(n));n.handlePauseMusic=n.handlePauseMusic.bind(pt(n));n.handleChangePlayProgress=n.handleChangePlayProgress.bind(pt(n));n.handleChangeVolumeProgress=n.handleChangeVolumeProgress.bind(pt(n));n.handleChangePlayMode=n.handleChangePlayMode.bind(pt(n));n.handleToggleMute=n.handleToggleMute.bind(pt(n));n.handlePlayPreMusic=n.handlePlayPreMusic.bind(pt(n));n.handlePlayNextMusic=n.handlePlayNextMusic.bind(pt(n));n.handlePlayAudio=n.handlePlayAudio.bind(pt(n));return n}ut(t,[{key:"componentDidMount",value:function e(){var t=this;this.props.dispatch(L());this.audio||(this.audio=document.getElementById("audio"));this.audio.ondurationchange=function(){t.props.dispatch(T(t.audio.duration))};this.audio.oncanplay=function(){t.props.dispatch(M())};this.audio.onerror=function(){t.handlePlayNextMusic()};this.audio.onended=this.handlePlayNextMusic}},{key:"componentWillReceiveProps",value:function e(t){var n=this;var r=this.props,a=r.mute,o=r.volumeProgress,i=r.play,c=r.musicId;t.mute!==a&&this.audio&&(this.audio.volume||0===this.audio.volume)&&(this.audio.volume=t.mute?0:t.volumeProgress);t.volumeProgress!==o&&this.audio&&(this.audio.volume||0===this.audio.volume)&&(this.audio.volume=t.volumeProgress);if(t.musicId!==c){var l=N.get(t.musicId,t.musics);if(this.audio)if(l.src){this.audio.src=l.src;this.handlePlayAudio()}else z(t.musicId).then(function(e){B(t.musicId).then(function(r){var a=r[0].al.picUrl;var o=e[0].url;t.dispatch(h(t.musicId,o,a));n.audio.src=o;n.handlePlayAudio()})}).catch(function(e){console.log(e)})}else if(t.play!==i)if(t.play){if(!this.audio.src){var u=N.get(t.musicId,t.musics);this.audio.src=u.src}this.handlePlayAudio()}else{this.task&&clearInterval(this.task);this.audio.pause()}}},{key:"handlePlayAudio",value:function e(){var t=this;this.audio.play().then(function(){t.task&&clearInterval(t.task);t.task=setInterval(function(){var e=0===t.audio.duration?0:t.audio.currentTime/t.audio.duration;t.handleChangePlayProgress(e)},1e3)}).catch(function(e){console.log(e)})}},{key:"handleAudioCanPlay",value:function e(){this.props.dispatch(T(this.audio.duration))}},{key:"handleToggleMusicList",value:function e(){this.props.dispatch(v())}},{key:"handlePlayMusic",value:function e(){this.props.dispatch(P())}},{key:"handlePauseMusic",value:function e(){this.props.dispatch(_())}},{key:"handleChangePlayProgress",value:function e(t,n){if(n){this.audio.currentTime=t*this.audio.duration;this.props.dispatch(L())}this.props.dispatch(b(t))}},{key:"handleChangeVolumeProgress",value:function e(t){this.props.dispatch(C(t))}},{key:"handleChangePlayMode",value:function e(){this.props.dispatch(O())}},{key:"handleToggleMute",value:function e(){this.props.dispatch(k())}},{key:"handlePlayPreMusic",value:function e(){this.props.dispatch(S())}},{key:"handlePlayNextMusic",value:function e(){this.props.dispatch(I())}},{key:"render",value:function e(){var t=this.props,n=t.loading,r=t.play,a=t.playProgress,o=t.volumeProgress,c=t.mode,l=t.mute,u=t.duration;var s="单曲循环";"random"===c?s="随机播放":"repeat"===c&&(s="列表循环");return i.a.createElement("div",{id:"playerControl",className:"Control"},i.a.createElement(me["d"],null,i.a.createElement(me["g"],null,i.a.createElement(me["g"].Row,{only:"computer"},i.a.createElement(me["g"].Column,{width:2},i.a.createElement(me["a"].Group,null,i.a.createElement(me["a"],{icon:"step backward",color:"red",onClick:this.handlePlayPreMusic}),r?i.a.createElement(me["a"],{icon:"pause",loading:n,color:"red",onClick:this.handlePauseMusic}):i.a.createElement(me["a"],{icon:"play",color:"red",onClick:this.handlePlayMusic}),i.a.createElement(me["a"],{icon:"step forward",color:"red",onClick:this.handlePlayNextMusic}))),i.a.createElement(me["g"].Column,{width:8},i.a.createElement(ot,{percent:a,onChangeProgress:this.handleChangePlayProgress})),i.a.createElement(me["g"].Column,{width:2,style:{marginLeft:"-1.5rem"}},N.parseTime(u*a),"/",N.parseTime(u)),i.a.createElement(me["g"].Column,{width:2,style:{marginLeft:"-3rem"}},i.a.createElement("div",{style:{float:"left"}},i.a.createElement(me["i"],{name:l?"volume off":"volume down",size:"large",onClick:this.handleToggleMute})),i.a.createElement(ot,{offsetX:"20%",percent:l?0:o,onChangeProgress:this.handleChangeVolumeProgress})),i.a.createElement(me["g"].Column,{width:2,style:{marginLeft:"3rem"}},i.a.createElement(me["a"].Group,{floated:"right",basic:true},i.a.createElement(me["r"],{trigger:i.a.createElement(me["a"],{icon:c,onClick:this.handleChangePlayMode}),on:"hover",content:s,position:"top center",size:"mini"}),i.a.createElement(me["r"],{trigger:i.a.createElement(me["a"],{content:"词",floated:"right"}),on:"hover",content:"歌词",position:"top center",size:"mini"}),i.a.createElement(me["r"],{trigger:i.a.createElement(me["a"],{icon:"list",floated:"left",onClick:this.handleToggleMusicList}),on:"hover",content:"播放列表",position:"top center",size:"mini"})))),i.a.createElement(me["g"].Row,{only:"tablet"},i.a.createElement(me["g"].Column,{width:3},i.a.createElement(me["a"].Group,null,i.a.createElement(me["a"],{icon:"step backward",color:"red",onClick:this.handlePlayPreMusic}),r?i.a.createElement(me["a"],{icon:"pause",loading:n,color:"red",onClick:this.handlePauseMusic}):i.a.createElement(me["a"],{icon:"play",color:"red",onClick:this.handlePlayMusic}),i.a.createElement(me["a"],{icon:"step forward",color:"red",onClick:this.handlePlayNextMusic}))),i.a.createElement(me["g"].Column,{width:8},i.a.createElement(ot,{percent:a,onChangeProgress:this.handleChangePlayProgress})),i.a.createElement(me["g"].Column,{width:2,style:{marginLeft:"-1.5rem"}},N.parseTime(u*a),"/",N.parseTime(u)),i.a.createElement(me["g"].Column,{width:2,textAlign:"right"},i.a.createElement(me["a"].Group,{basic:true},i.a.createElement(me["a"],{icon:c,onClick:this.handleChangePlayMode}),i.a.createElement(me["a"],{content:"词",floated:"right"}),i.a.createElement(me["a"],{icon:"list",floated:"left",onClick:this.handleToggleMusicList})))),i.a.createElement(me["g"].Row,{only:"mobile",style:{margin:"-.2rem 0 -1.8rem 0"}},i.a.createElement(me["g"].Column,{width:12},i.a.createElement(ot,{percent:a,onChangeProgress:this.handleChangePlayProgress})),i.a.createElement(me["g"].Column,{width:4,style:{marginLeft:"-1.5rem"}},N.parseTime(u*a),"/",N.parseTime(u))),i.a.createElement(me["g"].Row,{columns:3,only:"mobile"},i.a.createElement(me["g"].Column,{width:3},i.a.createElement(me["a"].Group,{floated:"left",basic:true},i.a.createElement(me["a"],{icon:c,onClick:this.handleChangePlayMode}))),i.a.createElement(me["g"].Column,{width:10,textAlign:"center"},i.a.createElement(me["a"].Group,null,i.a.createElement(me["a"],{icon:"step backward",color:"red",onClick:this.handlePlayPreMusic}),r?i.a.createElement(me["a"],{icon:"pause",loading:n,color:"red",onClick:this.handlePauseMusic}):i.a.createElement(me["a"],{icon:"play",color:"red",onClick:this.handlePlayMusic}),i.a.createElement(me["a"],{icon:"step forward",color:"red",onClick:this.handlePlayNextMusic}))),i.a.createElement(me["g"].Column,{width:3,textAlign:"right"},i.a.createElement(me["a"].Group,{basic:true},i.a.createElement(me["a"],{icon:"list",floated:"left",onClick:this.handleToggleMusicList})))))),i.a.createElement("audio",{id:"audio",loop:"lock"===c&&"loop"},i.a.createElement("track",{kind:"captions"})))}}]);return t}(o["Component"]);var ht=function e(t){return{loading:t.player.loading,play:t.player.play,playProgress:t.player.playProgress,volumeProgress:t.player.volumeProgress,mode:t.player.mode,mute:t.player.mute,duration:t.player.duration,musicId:t.player.musicId,musics:t.player.musics}};var mt=Object(he["connect"])(ht)(dt);function yt(e){yt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return yt(e)}function gt(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function i(e,t){try{var n=o[e](t);var i=n.value}catch(e){a(e);return}n.done?r(i):Promise.resolve(i).then(c,l)}function c(e){i("next",e)}function l(e){i("throw",e)}c()})}}function vt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Et(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;"value"in r&&(r.writable=true);Object.defineProperty(e,r.key,r)}}function bt(e,t,n){t&&Et(e.prototype,t);n&&Et(e,n);return e}function Ct(e,t){if(t&&("object"===yt(t)||"function"===typeof t))return t;return Pt(e)}function Pt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _t(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var St=function(e){_t(t,e);function t(){vt(this,t);return Ct(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}bt(t,[{key:"render",value:function e(){var t=this.props,n=t.musicId,r=t.musics;var a=N.get(n,r);var o=a&&a.cover?a.cover:this.cover;return[i.a.createElement("div",{key:"bg-component",className:"bg"},i.a.createElement("img",{alt:"aa",className:"filter",src:o})),i.a.createElement(Ke,{key:"content-component"}),i.a.createElement(mt,{key:"control-component"})]}}],[{key:"getInitialProps",value:function(){var e=gt(a.a.mark(function e(){var t;return a.a.wrap(function e(n){while(1)switch(n.prev=n.next){case 0:t={logo:{name:"music",text:"Music"},title:"「音乐播放器」"};return n.abrupt("return",{global:t});case 2:case"end":return n.stop()}},e,this)}));return function t(){return e.apply(this,arguments)}}()}]);return t}(o["Component"]);St.defaultProps={musics:[]};var It=function e(t){return{musicId:t.player.musicId,musics:t.player.musics}};var Ot=t["default"]=s()(pe,It,null)(Object(de["a"])(St))}},[984]);return{page:e.default}});